# HRM Microservices Architecture

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π HRM-—Å–∏—Å—Ç–µ–º—É, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **FastAPI**, **Kafka**, **Redis**, **PostgreSQL**, **MongoDB**, **JWT (RSA)**, **Nginx** –∏ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ **Prometheus + Grafana + Loki**.

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. **User-Auth Service**
- FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
- PostgreSQL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
- JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **RSA-–∫–ª—é—á–µ–π**.
- pg_cron –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö refresh-—Ç–æ–∫–µ–Ω–æ–≤
- **Redis** –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ access-—Ç–æ–∫–µ–Ω–æ–≤.

### 2. **Resume Service**
- FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑—é–º–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **MongoDB** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

---

## üîÑ –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

- **Kafka** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è:
  - üëâ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `user-auth` ‚Üí –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–∑—é–º–µ –≤ `resume-service`.

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- JWT —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ **RSA** (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è).
- –í—Å–µ access-—Ç–æ–∫–µ–Ω—ã –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ, Redis –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Ö –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏.
- Refresh-—Ç–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç access-—Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint.

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç   | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                  |
|-------------|----------------------------------------------|
| Prometheus  | –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫                       |
| Grafana     | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–æ–≤   |
| Loki        | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤    |

![Grafana dashboard](./assets/grafana.png)

---

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç        | –°—Ç–µ–∫                                          |
|------------------|-----------------------------------------------|
| Web Framework    | FastAPI                                       |
| –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö      | PostgreSQL (user-auth), MongoDB (resume)      |
| –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è JWT  | Redis                                         |
| –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π | Kafka                                         |
| –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è   | JWT (RSA)                                     |
| Reverse Proxy    | Nginx                                         |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥       | Prometheus + Grafana + Loki                   |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API | Swagger (FastAPI –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)                |
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è  | Docker, Docker Compose                        |

---

## üìÇ –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ infra/                       # –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞: Docker, Prometheus, Grafana, Nginx, RSA-–∫–ª—é—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yaml
‚îÇ   ‚îú‚îÄ‚îÄ poetry.lock              # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ pg_cron/                 # –°–æ–∑–¥–∞–Ω–∏–µ Dockerfile —Å pg_cron
‚îÇ   ‚îú‚îÄ‚îÄ keys/                    # RSA-–∫–ª—é—á–∏ –¥–ª—è JWT
‚îÇ   ‚îî‚îÄ‚îÄ logs/                    # –õ–æ–≥–∏ –¥–ª—è Loki
‚îÇ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ user_auth/               # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alembic/             # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                # –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (JWT, refresh –∏ —Ç.–ø.)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/            # SQLAlchemy –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Å—Å–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kafka_client/        # Kafka producer (—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ redis_client/        # Redis –¥–ª—è blacklist —Ç–æ–∫–µ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rank/             
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/            
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py           
‚îÇ   ‚îî‚îÄ‚îÄ resume/                 # –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Ä–µ–∑—é–º–µ
‚îÇ       ‚îú‚îÄ‚îÄ kafka_client/       # Kafka consumer (—É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–∑—é–º–µ)
‚îÇ       ‚îú‚îÄ‚îÄ redis_client/       
‚îÇ       ‚îú‚îÄ‚îÄ resume/         
‚îÇ       ‚îî‚îÄ‚îÄ main.py             
‚îÇ
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ readme.md
```
---

## üõ† –í –ø–ª–∞–Ω–∞—Ö

- üîÑ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD –ø–∞–π–ø–ª–∞–π–Ω–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è  
- üõ† –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Kubernetes –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é  

---